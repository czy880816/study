# Router

## 一、功能

路由规则决定了一个dubbo服务调用的目标服务器，其分为条件路由、标签路由和脚本路由,向注册中心写入路由规则的操作通常由监控中心或者控制管理台完成

### 1、TagRouter

规则：通过客户端和服务端配置标签来过滤服务的请求

a、客户端配置的tag，在Invoker列表中存在某个Invoker的tag与之匹配，则返回匹配的Invoker列表
b、若客户端配置的tag，在Invoker列表中任意一个Invoker的tag与之不匹配，则触发降级规则：返回没有配置tag的Invoker列表
c、如果客户端没有配置tag，则返回服务端没有配置tag的Invoker列表

### 2、ConditionRouter

规则：通过“=>”前后端来配置需要匹配的客户端和服务端的机器ip，若有多台机器，则需用","分隔

- =>前边表示消费者**匹配条件**，所有参数和消费者URL对比，当消费者满足匹配条件时，对该消费者执行后续的过滤规则
- =>后边表示提供者**过滤条件**，所有参数和提供者URL对比，当提供者满足匹配条件时，对该提供者执行后续过滤规则，消费者只拿到过滤后的提供者列表
- 当匹配条件为空时，表示对应所有的服务者，如："=> host = 127.0.0."
- 当过滤条件为空时，表示禁止访问，如："host = 127.0.0.1 & host != 127.0.0.2 =>" 

值支持：

- 以逗号分隔多个ip
- 以*结尾，表示通配
- 以$开头，表示值引用



## 二、Router的类图

