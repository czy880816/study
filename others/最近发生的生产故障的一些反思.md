最近生产上出了些问题，公司的运维在发版的时候几台机器同时发版，导致有部分交易失败，其产生的现象即有外系统调订单，又有订单系统调其他系统的情况。虽然重要交易都加上了重试机制，但是时间还是很短，而且感觉这种机制是一种特别消极的解决方案，不仅如此，10月11号发版导致某重要定时回调任务失败，最终导致交易失败，这两次故障后，反思了一下，单机的服务真的非常不可靠，这个场景就应该属于分布式理论CAP中的P，也就是分区容错性，针对这种问题，我想到了两种解决方案，如下：

1、将调用三方失败的请求参数缓存到数据库中，通过定时任务定时扫描去做定时“重试”，“重试”成功了更改其属性，否则继续跑。这种方案有个很大的缺陷：会影响数据库性能

2、因为系统中已经整合了rabbitmq，可以使用rabbitmq的死信队列实现定时任务，如果请求三方失败则将消息扔到队列里，直到重试成功。这种方案的缺陷就是实现上有些复杂，缺点暂时还没有想到，个人偏向于该方案